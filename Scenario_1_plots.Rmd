---
title: "Scenario 1 Plots"
output: html_document
date: "2024-04-28"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


``` {r, echo=FALSE, warning=FALSE, message=FALSE}
# Load the required libraries
library(tidyverse)

# Read the CSV file
data <- read_csv("Scenario1.csv")

# Create a function to generate the plot
create_plot <- function(df, sample_size, missing_type) {
  if (sample_size == 50) {
    knn_values <- c("knn5", "knn25")
  } else {
    knn_values <- c("knn100", "knn500")
  }
  
  color_values <- c("fiml" = "#FF6B6B", 
                    "mi" = "#4ECDC4",
                    "rf_flexible" = "#C7F464",
                    "rf_less_flexible" = "#C44D58")
  color_values[knn_values[1]] <- "#5B84B1"
  color_values[knn_values[2]] <- "#38A3A5"
  
  plot <- ggplot(df, aes(x = missing_percentage, y = abs(average_relative_bias) * 100, color = imputation_method)) +
    geom_line(size = 1) +
    scale_color_manual(values = color_values) +
    scale_y_continuous(breaks = seq(min(abs(df$average_relative_bias) * 100), max(abs(df$average_relative_bias) * 100), length.out = 5),
                       labels = function(x) paste0(format(x, digits = 2), "%")) +
    labs(title = paste("Sample Size =", sample_size, "| Missing Type =", missing_type),
         x = "Missing Percentage", y = "Absolute Average Relative Bias (%)", color = "Imputation Method") +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold", size = 14),
          axis.title = element_text(size = 12),
          axis.text.y = element_text(size = 10),
          legend.title = element_text(size = 12),
          legend.text = element_text(size = 10),
          legend.position = "bottom") +
    guides(color = guide_legend(nrow = 2))
  
  return(plot)
}

# Filter data and create separate plots
arb_plot_n50_mcar <- create_plot(data %>% filter(sample_size == 50, missing_type == "MCAR"), 50, "MCAR")
arb_plot_n50_mnar <- create_plot(data %>% filter(sample_size == 50, missing_type == "MNAR"), 50, "MNAR")
arb_plot_n1000_mcar <- create_plot(data %>% filter(sample_size == 1000, missing_type == "MCAR"), 1000, "MCAR")
arb_plot_n1000_mnar <- create_plot(data %>% filter(sample_size == 1000, missing_type == "MNAR"), 1000, "MNAR")

# Save the absolute average relative bias plots as PNG files
ggsave("abs_arb_plot_n50_mcar.png", plot = arb_plot_n50_mcar, width = 8, height = 6, dpi = 300)
ggsave("abs_arb_plot_n50_mnar.png", plot = arb_plot_n50_mnar, width = 8, height = 6, dpi = 300)
ggsave("abs_arb_plot_n1000_mcar.png", plot = arb_plot_n1000_mcar, width = 8, height = 6, dpi = 300)
ggsave("abs_arb_plot_n1000_mnar.png", plot = arb_plot_n1000_mnar, width = 8, height = 6, dpi = 300)

# Display the plots
print(arb_plot_n50_mcar)
print(arb_plot_n50_mnar)
print(arb_plot_n1000_mcar)
print(arb_plot_n1000_mnar)
```


```{r}
# Load the required libraries
library(tidyverse)

# Read the CSV file
data <- read_csv("Scenario1.csv")

# Create a function to generate the plot
create_plot <- function(df, sample_size, missing_type) {
  if (sample_size == 50) {
    knn_values <- c("knn5", "knn25")
  } else {
    knn_values <- c("knn100", "knn500")
  }
  
  color_values <- c("fiml" = "#FF6B6B", 
                    "mi" = "#4ECDC4",
                    "rf_flexible" = "#C7F464",
                    "rf_less_flexible" = "#C44D58")
  color_values[knn_values[1]] <- "#5B84B1"
  color_values[knn_values[2]] <- "#38A3A5"
  
  plot <- ggplot(df, aes(x = missing_percentage, y = coverage_probability * 100, color = imputation_method)) +
    geom_line(size = 1) +
    scale_color_manual(values = color_values) +
    scale_y_continuous(breaks = seq(80, 100, 2),
                       limits = c(80, 100),
                       labels = function(x) paste0(x, "%")) +
    labs(title = paste("Sample Size =", sample_size, "| Missing Type =", missing_type),
         x = "Missing Percentage", y = "Coverage Probability (%)", color = "Imputation Method") +
    theme_minimal() +
    theme(plot.title = element_text(face = "bold", size = 14),
          axis.title = element_text(size = 12),
          axis.text.y = element_text(size = 10),
          legend.title = element_text(size = 12),
          legend.text = element_text(size = 10),
          legend.position = "bottom") +
    guides(color = guide_legend(nrow = 2))
  
  return(plot)
}

# Filter data and create separate plots
cp_plot_n50_mcar <- create_plot(data %>% filter(sample_size == 50, missing_type == "MCAR"), 50, "MCAR")
cp_plot_n50_mnar <- create_plot(data %>% filter(sample_size == 50, missing_type == "MNAR"), 50, "MNAR")
cp_plot_n1000_mcar <- create_plot(data %>% filter(sample_size == 1000, missing_type == "MCAR"), 1000, "MCAR")
cp_plot_n1000_mnar <- create_plot(data %>% filter(sample_size == 1000, missing_type == "MNAR"), 1000, "MNAR")

# Display the plots
print(cp_plot_n50_mcar)
print(cp_plot_n50_mnar)
print(cp_plot_n1000_mcar)
print(cp_plot_n1000_mnar)
```





```{r}
# Save the absolute average relative bias plots as PNG files
ggsave("abs_arb_plot_n50_mcar.png", plot = arb_plot_n50_mcar, width = 8, height = 6, dpi = 600)
ggsave("abs_arb_plot_n50_mnar.png", plot = arb_plot_n50_mnar, width = 8, height = 6, dpi = 600)
ggsave("abs_arb_plot_n1000_mcar.png", plot = arb_plot_n1000_mcar, width = 8, height = 6, dpi = 600)
ggsave("abs_arb_plot_n1000_mnar.png", plot = arb_plot_n1000_mnar, width = 8, height = 6, dpi = 600)

# Save the coverage probability plots as PNG files
ggsave("cp_plot_n50_mcar.png", plot = cp_plot_n50_mcar, width = 8, height = 6, dpi = 600)
ggsave("cp_plot_n50_mnar.png", plot = cp_plot_n50_mnar, width = 8, height = 6, dpi = 600)
ggsave("cp_plot_n1000_mcar.png", plot = cp_plot_n1000_mcar, width = 8, height = 6, dpi = 600)
ggsave("cp_plot_n1000_mnar.png", plot = cp_plot_n1000_mnar, width = 8, height = 6, dpi = 600)
```